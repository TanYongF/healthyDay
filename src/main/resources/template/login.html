<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>主页</title>
		<!-- CSS  -->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<link rel="stylesheet" href="https://kauizhaotan.oss-cn-shanghai.aliyuncs.com/VotingSystem/css/materialize.min.css" type="text/css">
		<link rel="stylesheet" href="/css/me.css" type="text/css">
		<!--引入Jquery-->
		<script type="text/javascript" src="https://kauizhaotan.oss-cn-shanghai.aliyuncs.com/VotingSystem/js/jquery.js" charset="UTF-8"></script>
		<script type="text/javascript" src="https://kauizhaotan.oss-cn-shanghai.aliyuncs.com/VotingSystem/js/materialize.min.js" charset="UTF-8"></script>
		<!-- layer -->
		<!-- jquery -->
		<script th:src="@{/js/jquery.min.js}" type="text/javascript"></script>
		<!-- bootstrap -->
		<link rel="stylesheet" th:href="@{/bootstrap/css/bootstrap.min.css}" type="text/css"/>
		<script th:src="@{/bootstrap/js/bootstrap.min.js}" type="text/javascript"></script>
		<!-- jquery-validator -->
		<script th:src="@{/jquery-validation/jquery.validate.min.js}" type="text/javascript"></script>
		<script th:src="@{/jquery-validation/localization/messages_zh.min.js}" type="text/javascript"></script>
		<script th:src="@{/layer/layer.js}" type="text/javascript"></script>
		<!-- md5.js -->
		<script th:src="@{/js/md5.min.js}" type="text/javascript"></script>
		<!-- common.js -->
		<script th:src="@{/js/common.js}" type="text/javascript"></script>
	</head>
	<body>

		<form id="loginForm" method="post" name="loginForm" style="width:50%; margin:0 auto">
			<h2 style="text-align:center; margin-bottom: 20px">用户登录</h2>
			<div class="form-group">
				<div class="row">
					<label class="form-label col-md-4">请输入手机号码</label>
					<div class="col-md-5">
						<input class="form-control" id="mobile" maxlength="11" minlength="11" name="mobile"
						       placeholder="手机号码" required="true" type="text"/>
					</div>
					<div class="col-md-1">
					</div>
				</div>
			</div>

			<div class="form-group">
				<div class="row">
					<label class="form-label col-md-4">请输入密码</label>
					<div class="col-md-5">
						<input class="form-control" id="password" maxlength="16" minlength="6" name="password"
						       placeholder="密码" required="true" type="password"/>
					</div>
				</div>
			</div>

            <div class="row">
                <div class="col s2"></div>
                <div class="col s3">
                    <button class="btn btn-primary btn-block" onclick="reset()" type="reset">重置</button>
                </div>
                <div class="col s2"></div>
                <div class="col s3">
                    <button class="btn btn-primary btn-block" onclick="login()" type="submit">登录</button>
                </div>
            </div>

		</form>
	</body>
	<script>
        function login() {
            $("#loginForm").validate({
                submitHandler: function (form) {
                    doLogin();
                }
            });
        }

        function doLogin() {
            g_showLoading();

            var inputPass = $("#password").val();
            var salt = g_passsword_salt;
            var str = "" + salt.charAt(0) + salt.charAt(2) + inputPass + salt.charAt(5) + salt.charAt(4);
            var password = md5(str);

            $.ajax({
                url: "/login/do_login",
                type: "POST",
                data: {
                    mobile: $("#mobile").val(),
                    password: password
                },
                success: function (data) {
                    layer.closeAll();
                    if (data.code == 0) {
                        layer.msg("成功");
                        // window.location.href = "/goods/to_list";
                    } else {
                        layer.msg(data.msg);
                    }
                },
                error: function () {
                    layer.closeAll();
                }
            });
        }
	</script>
</html>